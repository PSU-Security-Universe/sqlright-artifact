# Bug_Chain for WITHOUT ROWID with DESC PRIMARY KEY:

This bug relies on the mutation of the NON-SELECT statement. Specifically, Mutation 4 and 5 which introduce DESC and WITHOUT ROWID to the generated table, is the most important trigger of the bug. 

The CREATE INDEX statement that is inserted from mutation 2, 6 and 7 is actualy optional. Since the original seed contains a CREATE INDEX statement, and the actual triggering INDEX belongs to the original seeds. 

Multiple bugs can be originated from 40.txt. If 40.txt is mutated to a wrong stage, e.g. become rtree table, then the triggering of these bugs would become hard. 

Source Seed:
```SQL
/* id:000046,orig:40.txt */
CREATE TABLE t1(i INTEGER PRIMARY KEY, a, b INTEGER);
INSERT INTO t1 VALUES(1, 1, 1);
INSERT INTO t1 VALUES(2, 1, 1);
INSERT INTO t1 VALUES(3, 1, 2);
INSERT INTO t1 VALUES(4, 1, 2);
INSERT INTO t1 VALUES(5, 1, 2);
INSERT INTO t1 VALUES(6, 1, 3);
INSERT INTO t1 VALUES(7, 1, 3);
INSERT INTO t1 VALUES(8, 2, 1);
INSERT INTO t1 VALUES(9, 2, 1);
INSERT INTO t1 VALUES(10, 2, 2);
INSERT INTO t1 VALUES(11, 2, 2);
INSERT INTO t1 VALUES(12, 2, 2);
INSERT INTO t1 VALUES(13, 2, 3);
INSERT INTO t1 VALUES(14, 2, 3);
INSERT INTO t1 VALUES(15, 2, 1);
INSERT INTO t1 VALUES(16, 2, 1);
INSERT INTO t1 VALUES(17, 2, 2);
INSERT INTO t1 VALUES(18, 2, 2);
INSERT INTO t1 VALUES(19, 2, 2);
INSERT INTO t1 VALUES(20, 2, 3);
INSERT INTO t1 VALUES(21, 2, 3);
CREATE INDEX i1 ON t1(a, b);
```

Mutation 1: Lind 2-3, Inserted two SELECT COUNT statements. 
```SQL
/* id:001831,src:000046,op:(null),pos:0 */
CREATE TABLE v0 ( c1 INTEGER PRIMARY KEY, c2, c3 INTEGER );
SELECT COUNT ( * ) FROM v0 AS a4, v0 AS a5 WHERE a5.c3 > a5.c2 AND a4.c3 = a5.c1;
WITH v0 ( c7 ) AS ( VALUES ( 127 ) UNION ALL SELECT a8.c1 + 60 FROM v0 AS a8 WHERE c7 < 18446744073709551615 ) SELECT COUNT ( * ) FROM v0 AS a6 WHERE a6.c2;
VALUES ( 18446744073709551615, 0, 9223372036854775807 );
INSERT INTO v0 VALUES ( 18446744073709551488, 2147483647, 127 );
INSERT INTO v0 VALUES ( 18446744073709551488, 255, 18446744071562067968 );
INSERT INTO v0 VALUES ( 18446744073709551615, 2802.800000, 8 );
INSERT INTO v0 VALUES ( 18446744073709551488, 18446744073709551488, 255 );
INSERT INTO v0 VALUES ( 18446744073709551615, 18446744073709551615, 0 );
INSERT INTO v0 VALUES ( 18446744073709551488, 255, 18446744073709551615 );
INSERT INTO v0 VALUES ( 0, 18446744073709518848, 18446744071562067968 );
INSERT INTO v0 VALUES ( 2147483647, 18446744073709518848, 57 );
INSERT INTO v0 VALUES ( 0, 255, 12.500000 );
INSERT INTO v0 VALUES ( 18446744073709551615, 0, 110 );
INSERT INTO v0 VALUES ( 127, 18446744073709551615, 18446744073709551615 );
INSERT INTO v0 VALUES ( 18446744073709551488, 8, 8 );
INSERT INTO v0 VALUES ( 18446744073709551615, 127, 9223372036854775807 );
INSERT INTO v0 VALUES ( 8, 2102.100000, 0 );
INSERT INTO v0 VALUES ( 9223372036854775807, 18446744071562067968, 127 );
INSERT INTO v0 VALUES ( 18446744073709551488, 5, 18446744073709518848 );
INSERT INTO v0 VALUES ( 18446744073709551615, 0, 1306 );
INSERT INTO v0 VALUES ( 18446744073709551488, 0, 18446744073709551615 );
INSERT INTO v0 VALUES ( 12.012000, 4294967295, 255 );
INSERT INTO v0 VALUES ( 2147483647, 8, 18446744071562067968 );
CREATE INDEX i9 ON v0 ( c2, c1 );
```

Mutation 2: Added a CREATE INDEX statement to the query sequence. 
```SQL
/* id:004020,src:001831,op:(null),pos:0,+cov */
CREATE TABLE v0 ( c1 INTEGER PRIMARY KEY, c2, c3 INTEGER );
INSERT INTO v0 VALUES ( 2147483647, 2147483647, 8 );
INSERT INTO v0 VALUES ( 18446744071562067968, 127, 9223372036854775807 );
CREATE INDEX i4 ON v0 ( c2, zeroblob ( 4294967295 LIKE 255 + 127 ), c1 );
VALUES ( 0, 0, 18446744073709518848 );
INSERT INTO v0 VALUES ( 814, 18446744073709551615, 127 );
INSERT INTO v0 VALUES ( 255, 8, 358 );
INSERT INTO v0 VALUES ( 0, 18446744073709551615, 127 );
INSERT INTO v0 VALUES ( 127, 2147483647, 0 );
INSERT INTO v0 VALUES ( 4294967295, 16, 4294967295 );
INSERT INTO v0 VALUES ( 18446744073709551488, 18446744073709551488, 18446744073709551488 );
INSERT INTO v0 VALUES ( 803, 18446744073709551488, 0 );
INSERT INTO v0 VALUES ( 220, 9223372036854775807, 18446744073709518848 );
INSERT INTO v0 VALUES ( 127, 16, 0 );
INSERT INTO v0 VALUES ( 18446744073709551615, 0, 18446744073709551615 );
INSERT INTO v0 VALUES ( 255, 18446744073709551615, 18446744073709551615 );
INSERT INTO v0 VALUES ( 18446744073709551488, 18446744073709551615, 255 );
INSERT INTO v0 VALUES ( 18446744073709551615, 18446744073709551488, 99 );
INSERT INTO v0 VALUES ( 913, 0, 18446744073709551488 );
INSERT INTO v0 VALUES ( 4294967295, 255, 18446744073709551488 );
INSERT INTO v0 VALUES ( 18446744073709551488, 18446744073709551488, 18446744073709551488 );
INSERT INTO v0 VALUES ( 0, 0, 18446744073709551488 );
CREATE INDEX i5 ON v0 ( c3, c2 );
```

Mutation 3: One INSERT statement has been mutated to INSERT INTO AS SELECT form. 
```SQL
/* id:005113,src:004020,op:(null),pos:0 */
CREATE TABLE v0 ( c1 INTEGER PRIMARY KEY, c2, c3 INTEGER );
INSERT INTO v0 VALUES ( 255, 18446744073709518848, 9223372036854775807 );
INSERT INTO v0 VALUES ( 18446744073709551615, 18446744073709551488, 18446744073709551615 );
CREATE INDEX i4 ON v0 ( c3, zeroblob ( 0 LIKE 8 + 255 ), c2 );
INSERT INTO v0 VALUES ( 127, 18446744073709518848, 16 );
INSERT INTO v0 VALUES ( 4294967295, 127, 16 );
INSERT INTO v0 VALUES ( 18446744073709551488, 18446744073709551615, 18446744073709551615 );
INSERT INTO v0 VALUES ( 2147483647, 127, 18446744073709551615 );
INSERT INTO v0 VALUES ( 18446744073709551615, 18446744073709551615, 0 );
INSERT INTO v0 VALUES ( 18446744073709518848, 0, 0 );
INSERT INTO v0 VALUES ( 18446744073709551488, 18446744073709551488, 18446744073709551615 );
INSERT INTO v0 VALUES ( 0, 18446744073709551615, 18446744073709551488 );
INSERT INTO v0 VALUES ( 18446744073709551615, 18446744073709551615, 18446744073709551615 );
INSERT INTO v0 VALUES ( 0, 18446744073709551488, 18446744073709551488 );
INSERT INTO v0 VALUES ( 0, 2147483647, 127 );
INSERT INTO v0 VALUES ( 0, 9223372036854775807, 18446744073709551615 );
INSERT INTO v0 VALUES ( 9223372036854775807, 255, 0 );
INSERT INTO v0 SELECT * FROM v0 AS a5 GROUP BY c3 HAVING c3 > 18446744073709518848;
INSERT INTO v0 VALUES ( 18446744073709551488, 18446744071562067968, 0 );
INSERT INTO v0 VALUES ( 0, 0, 0 );
INSERT INTO v0 VALUES ( 4294967295, 18446744073709551615, 18446744073709551615 );
INSERT INTO v0 VALUES ( 18446744073709551488, 18446744073709551488, 18446744073709551488 );
CREATE INDEX i6 ON v0 ( c1, c1 );
```

Mutation 4: **Critical** WITHOUT ROWID introduced. Line 1
```SQL
/* id:005682,src:005113,op:(null),pos:0 */
CREATE TABLE v0 ( c1 INTEGER PRIMARY KEY, c2, c3 INTEGER ) WITHOUT ROWID;
INSERT INTO v0 VALUES ( 4294967295, 18446744073709551488, 319 );
INSERT INTO v0 VALUES ( 1501.500000, 8, 18446744073709551615 );
CREATE INDEX i4 ON v0 ( c1, zeroblob ( 127 LIKE 45.045000 + 0 ), c2 );
INSERT INTO v0 VALUES ( 16, 0, 18446744073709518848 );
INSERT INTO v0 VALUES ( 18446744073709551615, 255, 8 );
INSERT INTO v0 VALUES ( 8, 255, 400 );
INSERT INTO v0 VALUES ( 18446744073709551488, 0, 18446744071562067968 );
INSERT INTO v0 VALUES ( 0, 18446744073709551615, 0 );
INSERT INTO v0 VALUES ( 18446744073709551488, 0, 18446744073709551615 );
INSERT INTO v0 VALUES ( 16, 255, 9223372036854775807 );
INSERT INTO v0 VALUES ( 0, 16, 0 );
INSERT INTO v0 VALUES ( 0, 18446744073709551615, 4294967295 );
INSERT INTO v0 VALUES ( 18446744073709551488, 255, 18446744073709551488 );
INSERT INTO v0 VALUES ( 18446744073709551488, 18446744073709518848, 18446744073709551615 );
INSERT INTO v0 VALUES ( 18446744073709518848, 2147483647, 9223372036854775807 );
INSERT INTO v0 VALUES ( 18446744073709551488, 18446744073709551615, 18446744073709551615 );
INSERT INTO v0 SELECT * FROM v0 AS a5 GROUP BY c3 HAVING c3 > 9223372036854775807;
INSERT INTO v0 VALUES ( 1301.300000, 127, 18446744073709551488 );
INSERT INTO v0 VALUES ( 16, 2147483647, 255 );
INSERT INTO v0 VALUES ( 18446744073709518848, 18446744071562067968, 18446744073709551488 );
INSERT INTO v0 VALUES ( 0, 18446744073709551615, 48 );
CREATE INDEX i6 ON v0 ( c3, c2 );
```

Mutation 5: **Critical** Introduced the critical CREATE TABLE statement. Replaced the query components with PRIMARY KEY DESC. 
```SQL
/* id:008744,src:005682,op:(null),pos:0 */
CREATE TABLE v0 ( c1 INTEGER PRIMARY KEY DESC ON CONFLICT REPLACE, c2, c3 INTEGER ) WITHOUT ROWID;
INSERT INTO v0 VALUES ( 18446744073709551615, 18446744073709551488, 0 );
INSERT INTO v0 VALUES ( 18446744073709551615, 18446744073709551488, 127 );
CREATE INDEX i4 ON v0 ( c3, zeroblob ( 127 LIKE 18446744073709551488 + 11.011000 ), c2 );
INSERT INTO v0 VALUES ( 127, 9223372036854775807, 0 );
INSERT INTO v0 VALUES ( 0, 2147483647, 18446744073709551615 );
INSERT INTO v0 VALUES ( 9223372036854775807, 18446744071562067968, 4294967295 );
INSERT INTO v0 VALUES ( 18446744073709551615, 18446744073709551488, 9223372036854775807 );
INSERT INTO v0 VALUES ( 16, 18446744073709551488, 18446744073709551615 );
INSERT INTO v0 VALUES ( 24, 18446744073709551615, 127 );
INSERT INTO v0 VALUES ( 0, 127, 18446744073709518848 );
INSERT INTO v0 VALUES ( 127, 18446744073709551488, 539 );
INSERT INTO v0 VALUES ( 255, 0, 0 );
INSERT INTO v0 VALUES ( 16, 9223372036854775807, 18446744073709551615 );
INSERT INTO v0 VALUES ( 1078, 18446744073709551615, 0 );
INSERT INTO v0 VALUES ( 127, 18446744073709551488, 0 );
INSERT INTO v0 VALUES ( 18446744073709551615, 8, 18446744073709518848 );
INSERT INTO v0 SELECT * FROM v0 AS a5 GROUP BY c1 HAVING c2 > 18446744073709551615;
INSERT INTO v0 VALUES ( 18446744073709551488, 4294967295, 255 );
INSERT INTO v0 VALUES ( 0, 2147483647, 16 );
INSERT INTO v0 VALUES ( 127, 18446744073709551615, 18446744071562067968 );
INSERT INTO v0 VALUES ( 8, 72, 18446744073709551488 );
CREATE INDEX i6 ON v0 ( c1, c2 );
```

Mutation 6: One INSERT INTO statement has been mutated to CREATE INDEX statement. 
```SQL
/* id:010159,src:008744,op:(null),pos:0 */
CREATE TABLE v0 ( c1 INTEGER PRIMARY KEY DESC ON CONFLICT REPLACE, c2, c3 INTEGER ) WITHOUT ROWID;
INSERT INTO v0 VALUES ( 9223372036854775807, 18446744073709551488, 1.300000 );
INSERT INTO v0 VALUES ( 18446744073709551615, 18446744073709551615, 18446744073709518848 );
CREATE INDEX i4 ON v0 ( c1, zeroblob ( 18446744073709551615 LIKE 0 + 86 ), c3 );
CREATE INDEX i5 ON v0 ( c1 || c1 || c3, c1 ) WHERE c3 = 0 AND c2 = 18446744073709518848 AND c3 = 4294967295;
INSERT INTO v0 VALUES ( 957, 18446744073709551488, 18446744073709518848 );
INSERT INTO v0 VALUES ( 18446744073709551615, 18446744073709551488, 127 );
INSERT INTO v0 VALUES ( 18446744073709551488, 0, 4294967295 );
INSERT INTO v0 VALUES ( 594, 0, 18446744073709518848 );
INSERT INTO v0 VALUES ( 1844674473709551615, 18446744073709551488, 18446744073709551488 );
INSERT INTO v0 VALUES ( 9223372036854775807, 18446744073709551488, 18446744073709551488 );
INSERT INTO v0 VALUES ( 8, 18446744073709518848, 127 );
INSERT INTO v0 VALUES ( 0, 8192, 9223372036854775807 );
INSERT INTO v0 VALUES ( 127, 127, 255 );
INSERT INTO v0 VALUES ( 18446744073709551488, 127, 18446744073709551615 );
INSERT INTO v0 VALUES ( 0.000000, 18446744073709551615, 18446744073709551615 );
INSERT INTO v0 VALUES ( 0, 0, 4294967295 );
INSERT INTO v0 SELECT * FROM v0 AS a6 GROUP BY c2 HAVING c2 > 255;
INSERT INTO v0 VALUES ( 0, 9223372036854775807, 0 );
INSERT INTO v0 VALUES ( 8, 255, 0 );
INSERT INTO v0 VALUES ( 0, 82, 127 );
INSERT INTO v0 VALUES ( 18446744073709551488, 0, 9223372036854775807 );
CREATE INDEX i7 ON v0 ( c3, c3 );
```


Buggy Query Source: Mutation 7: Another INSERT statement has been mutated to CREATE INDEX statement. 
```SQL
/* id:011048,src:010159,op:(null),pos:0 */
CREATE TABLE v0 ( c1 INTEGER PRIMARY KEY DESC ON CONFLICT REPLACE, c2, c3 INTEGER ) WITHOUT ROWID;
INSERT INTO v0 VALUES ( 0, 18446744073709551615, 16 );
INSERT INTO v0 VALUES ( 16, 16, 16 );
CREATE INDEX i4 ON v0 ( c1, zeroblob ( 9223372036854775807 LIKE 0 + 18446744071562067968 ), c2 );
CREATE INDEX i5 ON v0 ( c3 || c1 || c1, c2 ) WHERE c1 = 0 AND c2 = 127 AND c1 = 0;
CREATE INDEX i6 ON v0 ( 0 == 0, c1, c2, c2 );
INSERT INTO v0 VALUES ( 4294967295, 23.023000, 127 );
INSERT INTO v0 VALUES ( 18446744073709551488, 18446744073709551615, 9223372036854775807 );
INSERT INTO v0 VALUES ( 18446744073709551615, 0, 16 );
INSERT INTO v0 VALUES ( 9223372036854775807, 16, 869 );
INSERT INTO v0 VALUES ( 2147483647, 18446744073709551488, 8 );
INSERT INTO v0 VALUES ( 18446744073709551488, 16, 18446744073709551488 );
INSERT INTO v0 VALUES ( 16, 16, 18446744073709551488 );
INSERT INTO v0 VALUES ( 4294967295, 18446744073709551615, 18446744073709551488 );
INSERT INTO v0 VALUES ( 18446744071562067968, 56.056000, 18446744073709551488 );
INSERT INTO v0 VALUES ( 9223372036854775807, 18446744073709551615, 0 );
INSERT INTO v0 VALUES ( 18446744073709551488, 18446744073709551615, 4294967295 );
INSERT INTO v0 SELECT * FROM v0 AS a7 GROUP BY c2 HAVING c2 > 255;
INSERT INTO v0 VALUES ( 18446744071562067968, 18446744073709551488, 0 );
INSERT INTO v0 VALUES ( 18446744073709551488, 0, 2147483647 );
INSERT INTO v0 VALUES ( 495, 9223372036854775807, 8 );
INSERT INTO v0 VALUES ( 18446744073709551615, 16, 68.068000 );
CREATE INDEX i8 ON v0 ( c1, c1 );
```


Bug Triggering Query:
```SQL
CREATE TABLE v0 ( c1 INTEGER PRIMARY KEY DESC ON CONFLICT REPLACE, c2, c3 INTEGER ) WITHOUT ROWID;
INSERT INTO v0 VALUES ( 4294967295, 0, 9223372036854775807 );
INSERT INTO v0 VALUES ( 18446744073709551488, 121, 18446744073709551615 );
CREATE INDEX i4 ON v0 ( c1, zeroblob ( 0 LIKE 255 + 0 ), c3 );
CREATE INDEX i5 ON v0 ( c1 || c1 || c2, c3 ) WHERE c1 = 8 AND c2 = 18446744073709551488 AND c3 = 18446744073709551615;
CREATE INDEX i6 ON v0 ( 0 == 2147483647, c1, c2, c1 );
INSERT INTO v0 VALUES ( 18446744073709551615, 18446744071562067968, 18446744073709551615 );
INSERT INTO v0 VALUES ( 18446744073709551615, 8, 16 );
INSERT INTO v0 VALUES ( 18446744073709551488, 0, 127 );
INSERT INTO v0 VALUES ( 127, 18446744073709518848, 18446744073709551488 );
INSERT INTO v0 VALUES ( 18446744073709551488, 18446744073709551615, 0 );
INSERT INTO v0 VALUES ( 9223372036854775807, 0, 0 );
INSERT INTO v0 VALUES ( 16016, 0, 18446744073709551615 );
INSERT INTO v0 VALUES ( 18446744073709551488, 16, 18446744071562067968 );
INSERT INTO v0 VALUES ( 18446744073709551488, 18446744071562067968, 255 );
INSERT INTO v0 VALUES ( 4294967295, 0, 2147483647 );
INSERT INTO v0 VALUES ( 0, 2147483647, 0 );
INSERT INTO v0 ( c2, c3, c3, c1, c1, c2, c2, c2, c2, c3, c3, c1, c3, c3, c3, c1, c3, c1, c1, c3, c2, c2, c1, c2, c2, c1, c2, c3, c3, c1, c3, c3, c2, c1, c3, c1, c2, c1, c1, c1, c3, c1, c2, c2, c1, c1, c1, c1, c2, c2, c3, c3, c3, c3, c1, c1, c2, c3 ) SELECT * FROM v0 AS a7 GROUP BY c3 HAVING c1 > 18446744073709551615;
INSERT INTO v0 VALUES ( 255, 18446744073709551615, 255 );
INSERT INTO v0 VALUES ( 18446744073709551488, 32, 18446744073709551615 );
INSERT INTO v0 VALUES ( 2147483647, 19019, 127 );
INSERT INTO v0 VALUES ( 18446744073709518848, 18446744073709551488, 16 );
CREATE INDEX i8 ON v0 ( c3, c3 );

SELECT COUNT ( * ) FROM v0 AS a11, v0 AS a12, v0 AS a13 WHERE a11.c3 = 2147483647 AND a11.c1 <= 8 ORDER BY substr ( a11.c3, 18446744073709518848, 18446744073709551615 ) DESC;
SELECT TOTAL ( ( CAST ( a11.c3 = 2147483647 AND a11.c1 <= 8 AS BOOL ) ) != 0 ) FROM v0 AS a11, v0 AS a12, v0 AS a13 ORDER BY substr ( a11.c3, 18446744073709518848, 18446744073709551615 ) DESC;
```
